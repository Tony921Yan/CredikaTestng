package com.miyuan.request.api.order


import com.miyuan.com.TestContext
import com.miyuan.factory.MiyuanRequest
import com.miyuan.service.OrderService
import com.miyuan.util.DateUtil
class MysqlDbOrderList extends MiyuanRequest
{
    // 断言某时间内的MongoDB数据和MySQL的oms_com_income_result 数据对比
    MiyuanRequest resultDbAssert(TestContext testContext) {
        Date starttime = DateUtil.strToDate(testContext.starttime.toString())
        Date endtime = DateUtil.strToDate(testContext.endtime.toString())
        List dbOrders = OrderService.getuserchanneltiemOrdersFromMongo(Integer.parseInt(testContext.get("userId").toString()), testContext.channel.toString(), starttime, endtime)

        dbOrders.stream().forEach { dbOrder ->

            //读取MongoDB 表订单状态
            Integer dborderStatus = Integer.parseInt(dbOrder.get("orderStatus").toString())
            Date dbOrderCreateTime = DateUtil.strToDate(dbOrder.get("orderCreateTime").toString())
            Integer orderVersion = dbOrder.get("orderVersion")
            String uuid = dbOrder.get("channelOrderId").toString()
            String ordercreateTime = dbOrder.get("orderCreateTime").toString()
            String channel = dbOrder.get("channelCode")
            Date datatime = DateUtil.strToDate(ordercreateTime)
            String Daytime = DateUtil.dateToymd(datatime)
            //println(orderVersion)
            //判空
            if (!orderVersion) {
                println("orderVersion 为空")
            } else {
                //读取oms_com_income_result表对应的数据
                Integer sourcrVersion = OrderService.getMiyuanOrderIncomeResule(Daytime, channel, uuid).source_version
                Integer sourcrStatus = OrderService.getMiyuanOrderIncomeResule(Daytime, channel, uuid).source_status
                String OrderCreateTime = OrderService.getMiyuanOrderIncomeResule(Daytime, channel, uuid).source_create_time
               //println OrderCreateTime
                Date myslOrderCreateTime = DateUtil.strToDate(OrderCreateTime)
                //println(myslOrderCreateTime)
                assert orderVersion == sourcrVersion, "断言失败的UUID:" + uuid
                assert sourcrStatus == dborderStatus, "断言失败的UUID:" + uuid
                assert myslOrderCreateTime == dbOrderCreateTime, "断言失败的UUID:" + uuid
                //println("orderVersion："+orderVersion)

            }
        }
        return this
    }
// oms_com_income_stat_channel_day统计表数据核对
    MiyuanRequest dayCountAssert(TestContext testContext) {

        String starttime = testContext.starttime.toString()
        Date dateStarTime = DateUtil.strToDate(starttime)
        String endtime = testContext.endtime.toString()
        Date dateEndTime = DateUtil.strToDate(endtime)
        String channel = testContext.channel.toString()
        Integer userId = Integer.parseInt(testContext.userId.toString())
        List orderStatus = new ArrayList()
        testContext.orderStatus.toString().split(",").each {it->orderStatus.add(Integer.parseInt(it.toString()))}
        //assert itemDayCount > 0
      List mysqlChanneldaylist = OrderService.getMysqlChannlDay(userId, channel, dateStarTime)

        mysqlChanneldaylist.stream().forEach { mysqlChannelday ->
            String statKey = mysqlChannelday.getAt("stat_key")

            switch (statKey){
                case 'CPS_ESTIMATE':
                    Integer itemDayCount = OrderService.getOrderItemCount(userId, channel, starttime, endtime).itemCunt
                    Integer sumDayCommission =OrderService.getOrderItemCommission(userId, channel, starttime, endtime).itemCommission

                    List dbDaySum = OrderService.getSumOrder(userId, channel, orderStatus,dateStarTime,dateEndTime)

                    Integer dbDaySumSize =dbDaySum.size()
                    if (dbDaySumSize == 0){
                        assert itemDayCount == mysqlChannelday.get("count")
                        assert mysqlChannelday.get("commission") == 0
                        assert sumDayCommission == null
                        assert  mysqlChannelday.get("count")   == 0
                        assert mysqlChannelday.get("commission")==0
                        println("预估某天统计订单数"+itemDayCount+";;预估某天佣金"+sumDayCommission+";;mongodb订单数空"+";;mongodb佣金总数空")

                    }else {
                        Integer dbCount =dbDaySum.get(0).cnt
                        Integer dbCommission =dbDaySum.get(0).commission
                        assert  dbCount == mysqlChannelday.get("count")
                        assert dbCommission ==mysqlChannelday.get("commission")
                        println("预估某天统计订单数"+itemDayCount+";;预估某天佣金"+sumDayCommission+";;mongodb订单数"+dbCount+";;mongodb佣金总数"+dbCommission)
                    }


                break;
                case 'CPS_SETTLE':
                    Integer settleItemDayCount=OrderService.getOrderSettleItemCount(userId, channel, starttime, endtime).itemCunt
                    Integer sumSettleDayCommission =OrderService.getOrderSettleItemCommission(userId, channel, starttime, endtime).itemCommission
                    List dbDaySettleSum = OrderService.getSumSettleOrder(userId, channel,dateStarTime,dateEndTime)
                    Integer dbDaySettleSumSize =dbDaySettleSum.size()
                    if(dbDaySettleSumSize == 0){
                        assert settleItemDayCount == mysqlChannelday.get("count")
                        assert mysqlChannelday.get("commission")==0
                        assert sumSettleDayCommission ==null
                        assert mysqlChannelday.get("count") == 0
                        assert  mysqlChannelday.get("commission")== 0
                        println("预估某天统计结算订单数"+settleItemDayCount+";;预估某天结算佣金"+sumSettleDayCommission+";;mongodb订单数空"+";;mongodb佣金总数空")

                    }else {
                        Integer dbSettleCount =dbDaySettleSum.get(0).cnt
                        Integer dbSettleCommission =dbDaySettleSum.get(0).commission
                        assert dbSettleCount == mysqlChannelday.get("count")
                        assert  dbSettleCommission== mysqlChannelday.get("commission")
                        println("预估某天统计结算订单数"+settleItemDayCount+";;预估某天结算佣金"+sumSettleDayCommission+";;mongodb订单数"+dbSettleCount+";;mongodb佣金总数"+dbSettleCommission)

                    }
                break;
                case 'CPS_payment':
                    println("没有付款统计")
                break;
                default:
                    println("统计类型不匹配");
            }
        }
    }

    //循环查某天起的day 统计
    MiyuanRequest forDayCountAssert(TestContext testContext) {
        String starttime = testContext.starttime.toString()
        Date dateStarTime = DateUtil.strToDate(starttime)
        String endtime = testContext.endtime.toString()
        Date dateEndTime = DateUtil.strToDate(endtime)
        String channel = testContext.channel.toString()
      // Integer userId = Integer.parseInt(testContext.userId.toString())
        List orderStatus = new ArrayList()
        testContext.orderStatus.toString().split(",").each {it->orderStatus.add(Integer.parseInt(it.toString()))}
        //assert itemDayCount > 0
        List<Integer> userIds =[
                8342532   ,
                26483332  ,
                12878404  ,
                28905284  ,
                6833412   ,
                8052164   ,
                27385028  ,
                10672900  ,
                12903684  ,
                9911876   ,
                15391940  ,
                8074116   ,
                17492932  ,
                7867396   ,
                28059140  ,
                15496452  ,
                7019332   ,
                6647108   ,
                9410820   ,
                8611588   ,
                6646148   ,
                8764548   ,
                6859524   ,
                6794628   ,
                23891972  ,
                7797444   ,
                18093956  ,
                17324228  ,
                23092868  ,
                7533252   ,
                22641092  ,
                9713156   ,
                20498180  ,
                6934468   ,
                19460740  ,
                10643780  ,
                7455108   ,
                22047684  ,
                24085700  ,
                19156484  ,
                6746116   ,
                28777476  ,
                6585604   ,
                26698692  ,
                18832708  ,
                6617476   ,
                16954308  ,
                21531012  ,
                7088452   ,
                8348292   ,
                9154564   ,
                7273604   ,
                8507396   ,
                17801028  ,
                23868676  ,
                6976004   ,
                7086148   ,
                22079620  ,
                8550788   ,
                22085572  ,
                11022724  ,
                15841732  ,
                21845444  ,
                24036356  ,
                18295812  ,
                16917572  ,
                6772356   ,
                17206717  ,
                7369341   ,
                9669437   ,
                15674493  ,
                11984445  ,
                20772861  ,
                12866493  ,
                22415997  ,
                6707837   ,
                17286333  ,
                7315581   ,
                25773565  ,
                7059901   ,
                6132989   ,
                20846077  ,
                7406141   ,
                20325181  ,
                7361533   ,
                24569405  ,
                17631037  ,
                20674685  ,
                27334141  ,
                7886653   ,
                7621885   ,
                18624957  ,
                7133693   ,
                8325565   ,
                7388733   ,
                7002301   ,
                14718333  ,
                29068477  ,
                1696637   ,
                13620349  ,
                7777533   ,
                9037629   ,
                9719613   ,
                2101821   ,
                14961469  ,
                6765757   ,
                6965181   ,
                8317437   ,
                10375613  ,
                17438269  ,
                6576509   ,
                12105277  ,
                7592061   ,
                17700669  ,
                7371581   ,
                16030653  ,
                8344893   ,
                6664637   ,
                1688957   ,
                27007933  ,
                8657597   ,
                3289213   ,
                16938301  ,
                9955773   ,
                6955773   ,
                13737341  ,
                9639165   ,
                19714749  ,
                20841789  ,
                24268925  ,
                16363261  ,
                8685117   ,
                20807293  ,
                16888189  ,
                13829757  ,
                10155325  ,
                29448765  ,
                7004770   ,
                28584418  ,
                26601890  ,
                7419234   ,
                10733538  ,
                22965410  ,
                24322594  ,
                17505570  ,
                15637026  ,
                7771938   ,
                6969506   ,
                9674466   ,
                18294946  ,
                22838242  ,
                28332450  ,
                7426338   ,
                16061090  ,
                8467554   ,
                23913186  ,
                14467490  ,
                29587746  ,
                6765410   ,
                7912098   ,
                26993698  ,
                13699746  ,
                9341538   ,
                29859106  ,
                22638818  ,
                13165282  ,
                11898466  ,
                9804066   ,
                12883682  ,
                29523170  ,
                8536354   ,
                7688674   ,
                9610594   ,
                22228002  ,
                10116514  ,
                7387106   ,
                16001314  ,
                23897378  ,
                7487842   ,
                7525218   ,
                28311650  ,
                10705186  ,
                29327458  ,
                8436578   ,
                25269346  ,
                7932834   ,
                7787042   ,
                28344418  ,
                8358434   ,
                13643106  ,
                22697570  ,
                27605730  ,
                14524962  ,
                13786018  ,
                11937442  ,
                21630370  ,
                9874402   ,
                23363106  ,
                19124834  ,
                8409826   ,
                21636834  ,
                22751074  ,
                17383330  ,
                22355426  ,
                15382434  ,
                21751202  ,
                20034274  ,
                8410274   ,
                28589282  ,
                27467362  ,
                21994018  ,
                10530274  ,
                27117794  ,
                17023330  ,
                28962018  ,
                13332770  ,
                27022306  ,
                14655202  ,
                17038306  ,
                11503394  ,
                26141026  ,
                29462690  ,
                12594274  ,
                12740642  ,
                7602914   ,
                26090786  ,
                26895906  ,
                19244258  ,
                9327010   ,
                7564002   ,
                6934306   ,
                8137314   ,
                6863010   ,
                16258530  ,
                12308578  ,
                9543650   ,
                7413026   ,
                17285026  ,
                22447842  ,
                9408162   ,
                25373282  ,
                15400866  ,
                9401506   ,
                10551266  ,
                8643938   ,
                12492770  ,
                9146530   ,
                28957730  ,
                21339042  ,
                8290466   ,
                10987618  ,
                10916450  ,
                22463202  ,
                16458786  ,
                12284770  ,
                23178018  ,
                28937570  ,
                13478882  ,
                14162786  ,
                7539042   ,
                23882850  ,
                7863586   ,
                19481122  ,
                7597986   ,
                16042338  ,
                6706146   ,
                6720546   ,
                12837346  ,
                27500962  ,
                21645154  ,
                27176802  ,
                15799330  ,
                11195298  ,
                13931234  ,
                16914722  ,
                15763938  ,
                10752994  ,
                8532770   ,
                26402786  ,
                7845346   ,
                22087906  ,
                28088482  ,
                21539298  ,
                7749090   ,
                7451490   ,
                22027682  ,
                8815394   ,
                12623906  ,
                8505314   ,
                15562082  ,
                6894434   ,
                14399906  ,
                7470178   ,
                7636450   ,
                6676578   ,
                27797794  ,
                28577378  ,
                8998050   ,
                7397730   ,
                25887586  ,
                8215586   ,
                8962018   ,
                8276450   ,
                21171298  ,
                16919330  ,
                11400610  ,
                7437410   ,
                7991330   ,
                12215906  ,
                24493346  ,
                13142754  ,
                9819426   ,
                18007074  ,
                23975650  ,
                9318114   ,
                1904674   ,
                27515106  ,
                7712546   ,
                10015202  ,
                14161314  ,
                17763042  ,
                28844706  ,
                17223010  ,
                7754722   ,
                12819234  ,
                7980642   ,
                12962274  ,
                29343458  ,
                16306018  ,
                12494690  ,
                11661986  ,
                8079906   ,
                20235938  ,
                12796130  ,
                10302882  ,
                19264226  ,
                24856226  ,
                26829602  ,
                23101986  ,
                10586914  ,
                1456482   ,
                7350882   ,
                7830690   ,
                12291874  ,
                25822114  ,
                17367202  ,
                27872738  ,
                29192866  ,
                29394082  ,
                9374178   ,
                20700898  ,
                8378530   ,
                29863842  ,
                6971938   ,
                9801058   ,
                23235490  ,
                23921250  ,
                7987106   ,
                9600930   ,
                15855906  ,
                22239394  ,
                6966114   ,
                20725154  ,
                29808802  ,
                10286114  ,
                27059362  ,
                21380898  ,
                25071266  ,
                16933282  ,
                16002082  ,
                21647778  ,
                23228322  ,
                28022882  ,
                18185570  ,
                21207778  ,
                7008802   ,
                8079010   ,
                29035106  ,
                24775010  ,
                25722722  ,
                23139170  ,
                11587938  ,
                7979298   ,
                18278690  ,
                8317666   ,
                7606114   ,
                21585506  ,
                16024482  ,
                10571938  ,
                27883362  ,
                16762658  ,
                17678114  ,
                7304674   ,
                7572066   ,
                6722082   ,
                14086178  ,
                25723938  ,
                8532706   ,
                7617378   ,
                23871202  ,
                13426594  ,
                8354850   ,
                16877986  ,
                20336034  ,
                22051042  ,
                7800674   ,
                3875234   ,
                7561890   ,
                22563810  ,
                16637538  ,
                7684578   ,
                10916834  ,
                12933730  ,
                9100514   ,
                8200162   ,
                7803298   ,
                7879010   ,
                6912802   ,
                27800930  ,
                13043106  ,
                17958306  ,
                28255906  ,
                8901026   ,
                12524258  ,
                26449762  ,
                27389218  ,
                23848418  ,
                6807522   ,
                6991586   ,
                14996322  ,
                10979746  ,
                10976226  ,
                29324386  ,
                13277538  ,
                18828514  ,
                11118242  ,
                8767074   ,
                15011234  ,
                6747554   ,
                16326178  ,
                15386722  ,
                29196962  ,
                14304098  ,
                11026210  ,
                7324386   ,
                7104034   ,
                24006498  ,
                7662434   ,
                12724898  ,
                16201954  ,
                7122850   ,
                27898338  ,
                13994210  ,
                16149207  ,
                9362327   ,
                27910295  ,
                28584663  ,
                21793367  ,
                20917847  ,
                29454167  ,
                14183895  ,
                19602775  ,
                14725143  ,
                1307351   ,
                9301463   ,
                10216535  ,
                6747159   ,
                17510935  ,
                24004311  ,
                8682967   ,
                25825623  ,
                28540311  ,
                8032087   ,
                24098327  ,
                15267223  ,
                7265559   ,
                7437591   ,
                16009367  ,
                26618519  ,
                9795159   ,
                24564759  ,
                15356503  ,
                7515607   ,
                9202967   ,
                25676183  ,
                25203415  ,
                20653527  ,
                22242583  ,
                7505239   ,
                24299095  ,
                7036823   ,
                22853655  ,
                7560023   ,
                13867287  ,
                23069911  ,
                13247575  ,
                16675415  ,
                9159383   ,
                7859927   ,
                7343063   ,
                12190231  ,
                1565399   ,
                13382871  ,
                13509143  ,
                13345687  ,
                17284567  ,
                14719575  ,
                22664471  ,
                28269399  ,
                22505239  ,
                18080023  ,
                11992983  ,
                6681239   ,
                10141015  ,
                7325591   ,
                16364311  ,
                22472663  ,
                8934487   ,
                22630743  ,
                22122007  ,
                11628439  ,
                7931927   ,
                10202327  ,
                7249367   ,
                26938903  ,
                7657431   ,
                14017303  ,
                22735639  ,
                8144087   ,
                1133271   ,
                12387863  ,
                13074711  ,
                17002455  ,
                7338903   ,
                20575191  ,
                18160023  ,
                7836951   ,
                6734551   ,
                7254487   ,
                22408727  ,
                7544983   ,
                8219415   ,
                13116759  ,
                8432087   ,
                27480023  ,
                21839511  ,
                26381847  ,
                9701207   ,
                29175511  ,
                16952535  ,
                12504023  ,
                22309271  ,
                22973975  ,
                11199767  ,
                9656727   ,
                14951511  ,
                21277783  ,
                29749847  ,
                18552087  ,
                12517271  ,
                27376471  ,
                13320407  ,
                3049495   ,
                11665047  ,
                6749911   ,
                8779159   ,
                26881239  ,
                8105431   ,
                15106711  ,
                13245591  ,
                28717975  ,
                25105559  ,
                28682903  ,
                13300887  ,
                25078039  ,
                1744919   ,
                15434199  ,
                10762071  ,
                8289239   ,
                13965335  ,
                28518039  ,
                6866967   ,
                22191575  ,
                21096087  ,
                10761367  ,
                8383511   ,
                7462807   ,
                13462359  ,
                10952151  ,
                19422167  ,
                6585239   ,
                15429527  ,
                14595031  ,
                20681175  ,
                23883543  ,
                23146007  ,
                11654359  ,
                12116183  ,
                29304087  ,
                6626711   ,
                26362199  ,
                27715287  ,
                13632023  ,
                14461719  ,
                8592855   ,
                16600215  ,
                15821079  ,
                1426071   ,
                23831767  ,
                7605463   ,
                9342295   ,
                9878743   ,
                9912983   ,
                21115607  ,
                7624279   ,
                28079447  ,
                13216023  ,
                29517207  ,
                19388695  ,
                11981143  ,
                16044759  ,
                27194711  ,
                29509399  ,
                20316631  ,
                8551447   ,
                18349143  ,
                8488279   ,
                19205271  ,
                17982231  ,
                6976279   ,
                29319319  ,
                23045847  ,
                7771543   ,
                12030551  ,
                19681687  ,
                6964951   ,
                29122839  ,
                20862359  ,
                8817559   ,
                7019287   ,
                26478295  ,
                13003607  ,
                28093463  ,
                20978839  ,
                23684631  ,
                7316887   ,
                18545111  ,
                10696663  ,
                23688855  ,
                6626135   ,
                8158423   ,
                22687703  ,
                10868183  ,
                8332439   ,
                11996183  ,
                14816407  ,
                15395927  ,
                12108951  ,
                29133655  ,
                12523479  ,
                8099287   ,
                9293207   ,
                28452119  ,
                6949719   ,
                6760343   ,
                6880727   ,
                22707671  ,
                28042071  ,
                20810839  ,
                15654103  ,
                18526103  ,
                13738519  ,
                20219095  ,
                20860759  ,
                12539991  ,
                25282135  ,
                19917783  ,
                11245527  ,
                17196503  ,
                13040407  ,
                8942935   ,
                28353495  ,
                7115863   ,
                6845271   ,
                16834711  ,
                13582935  ,
                7504663   ,
                24087511  ,
                10807703  ,
                11134807  ,
                21642007  ,
                8118807   ,
                24425815  ,
                14959703  ,
                8225943   ,
                23592343  ,
                28078743  ,
                19985943  ,
                14889175  ,
                14482135  ,
                22728471  ,
                19296855  ,
                13358167  ,
                25609623  ,
                17445527  ,
                21771223  ,
                8990359   ,
                10739735  ,
                16828247  ,
                23408983  ,
                12084311  ,
                8369815   ,
                11218071  ,
                6055511   ,
                9728407   ,
                9069655   ,
                18010071  ,
                10307671  ,
                11582231  ,
                15796695  ,
                14529175  ,
                23964119  ,
                15699863  ,
                29764759  ,
                26660247  ,
                28653335  ,
                12875223  ,
                9779095   ,
                20050327  ,
                29285655  ,
                12690711  ,
                14333399  ,
                11111127  ,
                8595799   ,
                9016215   ,
                21848407  ,
                28973015  ,
                1789271   ,
                16332887  ,
                20217431  ,
                10005655  ,
                20546263  ,
                21157719  ,
                15047511  ,
                18571671  ,
                10140887  ,
                7049111   ,
                28234903  ,
                22384151  ,
                27032535  ,
                10686103  ,
                19958743  ,
                22942871  ,
                21278807  ,
                6441495   ,
                15251223  ,
                18813399  ,
                13661591  ,
                14071319  ,
                8307735   ,
                12327319  ,
                24770391  ,
                29646039  ,
                14114199  ,
                10358871  ,
                14049815  ,
                13087831  ,
                7390679   ,
                16591319  ,
                16384791  ,
                12367383  ,
                2737431   ,
                9140823   ,
                21219799  ,
                16539543  ,
                7893911   ,
                24265687  ,
                17723991  ,
                14918039  ,
                11558295  ,
                23432087  ,
                24033303  ,
                8462807   ,
                15086167  ,
                17737175  ,
                12365527  ,
                10008535  ,
                28080919  ,
                29559831  ,
                21052247  ,
                7989911   ,
                10243031  ,
                27723927  ,
                6914967   ,
                7304855   ,
                13953367  ]
        Integer userIdSize = userIds.size()
        for (Integer i =0; i<userIdSize;i++){
            Integer userId = userIds.get(i)

            Date tmp = dateStarTime
            Calendar dd = Calendar.getInstance()
            dd.setTime(dateStarTime)
            while (tmp.getTime() < dateEndTime.getTime()) {
                tmp = dd.getTime()
                String tmpStr = DateUtil.dateToStr(tmp)
                Date tmpEnd= DateUtil.dateAdd(tmp,Calendar.MONTH,1)
                String tmpEndStr =DateUtil.dateToStr(tmpEnd)
                List mysqlChanneldaylist = OrderService.getMysqlChannlDay(userId, channel, tmp)
                Integer mysqlChanneldaylistSize = mysqlChanneldaylist.size()
                Integer itemDayCount = OrderService.getOrderItemCount(userId, channel, tmpStr, tmpEndStr).itemCunt
                Integer sumDayCommission =OrderService.getOrderItemCommission(userId, channel, tmpStr, tmpEndStr).itemCommission
                List dbDaySum = OrderService.getSumOrder(userId, channel, orderStatus,tmp,tmpEnd)
                Integer dbDaySumSize =dbDaySum.size()
                if (mysqlChanneldaylistSize ==0 && dbDaySumSize == 0){
                    println itemDayCount ==0
                    println sumDayCommission ==null
                    println("用户："+userId+"；；统计天数"+tmpStr+";;预估某天统计订单数"+itemDayCount+";;预估某天佣金"+sumDayCommission+";;mongodb订单数空"+";;mongodb佣金总数空")

                }
                else {
                mysqlChanneldaylist.stream().forEach { mysqlChannelday ->
                    String statKey = mysqlChannelday.getAt("stat_key")

                    switch (statKey){
                        case 'CPS_ESTIMATE':

                            if (dbDaySumSize == 0){
                                println itemDayCount == mysqlChannelday.get("count")
                                println mysqlChannelday.get("commission") == 0
                                println sumDayCommission == null
                                println  mysqlChannelday.get("count")   == 0
                                println mysqlChannelday.get("commission")==0
                                println("用户："+userId+"；；统计天数"+tmpStr+";;预估某天统计订单数"+itemDayCount+";;预估某天佣金"+sumDayCommission+";;mongodb订单数空"+";;mongodb佣金总数空")

                            }else {
                                Integer dbCount =dbDaySum.get(0).cnt
                                Integer dbCommission =dbDaySum.get(0).commission
                                println  dbCount == mysqlChannelday.get("count")
                                println dbCommission ==mysqlChannelday.get("commission")
                                println("用户："+userId+"；；统计天数"+tmpStr+";;预估某天统计订单数"+itemDayCount+";;预估某天佣金"+sumDayCommission+";;mongodb订单数"+dbCount+";;mongodb佣金总数"+dbCommission)
                            }

                            break;
                        case 'CPS_SETTLE':
                            Integer settleItemDayCount=OrderService.getOrderSettleItemCount(userId, channel, tmpStr, tmpEndStr).itemCunt
                            Integer sumSettleDayCommission =OrderService.getOrderSettleItemCommission(userId, channel, tmpStr, tmpEndStr).itemCommission
                            List dbDaySettleSum = OrderService.getSumSettleOrder(userId, channel,tmp,tmpEnd)
                            Integer dbDaySettleSumSize =dbDaySettleSum.size()
                            if(dbDaySettleSumSize == 0){
                                println settleItemDayCount == mysqlChannelday.get("count")
                                println mysqlChannelday.get("commission")==0
                                println sumSettleDayCommission ==null
                                println mysqlChannelday.get("count") == 0
                                println  mysqlChannelday.get("commission")== 0
                                println("用户："+userId+"；；统计天数"+tmpStr+";;预估某天统计结算订单数"+settleItemDayCount+";;预估某天结算佣金"+sumSettleDayCommission+";;mongodb订单数空"+";;mongodb佣金总数空")

                            }else {
                                Integer dbSettleCount =dbDaySettleSum.get(0).cnt
                                Integer dbSettleCommission =dbDaySettleSum.get(0).commission
                                println dbSettleCount == mysqlChannelday.get("count")
                                println  dbSettleCommission== mysqlChannelday.get("commission")
                                println("用户："+userId+"；；统计天数"+tmpStr+";;预估某天统计结算订单数"+settleItemDayCount+";;预估某天结算佣金"+sumSettleDayCommission+";;mongodb订单数"+dbSettleCount+";;mongodb佣金总数"+dbSettleCommission)

                            }
                            break;
                        case 'CPS_payment':
                            println("没有付款统计")
                            break;
                        default:
                            println("统计类型不匹配");
                    }
                }
                }
                // 天数加上1
                dd.add(Calendar.DAY_OF_MONTH, 1)
            }
        }


    }

//oms_com_income_stat_channel_month_YYYYMM 数据核对
MiyuanRequest monthCountAssert(TestContext testContext) {
    String starttime = testContext.starttime.toString()
    Date dateTime = DateUtil.strToDate(starttime)
    String endtime = testContext.endtime.toString()
    String channel = testContext.channel.toString()
    Integer userId = Integer.parseInt(testContext.userId.toString())


    //assert itemDayCount > 0
    List mysqlChannelMonthlist = OrderService.getMysqlChannlMonth(userId,channel,dateTime)

    mysqlChannelMonthlist.stream().forEach { mysqlChannelMonth ->
        String statKey = mysqlChannelMonth.getAt("stat_key")

        switch (statKey){
            case 'CPS_ESTIMATE':
                Integer itemMonthCount = OrderService.getOrderItemCount(userId, channel, starttime, endtime).itemCunt
                Integer sumMonthCommission =OrderService.getOrderItemCommission(userId, channel, starttime, endtime).itemCommission
                assert itemMonthCount == mysqlChannelMonth.get("count")
                assert sumMonthCommission ==mysqlChannelMonth.get("commission")
                println("预估统计订单数"+itemMonthCount+";;预估佣金"+sumMonthCommission)
                break;
            case 'CPS_SETTLE':
                Integer settleItemMonthCount=OrderService.getOrderSettleItemCount(userId, channel, starttime, endtime).itemCunt
                Integer sumSettleMonthCommission =OrderService.getOrderSettleItemCommission(userId, channel, starttime, endtime).itemCommission
                assert settleItemMonthCount == mysqlChannelMonth.get("count")
                assert sumSettleMonthCommission ==mysqlChannelMonth.get("commission")
                println("预估统计结算订单数"+settleItemMonthCount+";;预估结算佣金"+sumSettleMonthCommission)
                break;
            case 'CPS_payment':
                println("没有付款统计")
                break;
            default:
                println("统计类型不匹配");
        }
    }
}

//oms_com_income_stat_channel_month_YYYYMM 循环数据核对
    MiyuanRequest ForMonthCountAssert(TestContext testContext) {
        String starttime = testContext.starttime.toString()
        Date dateStarTime = DateUtil.strToDate(starttime)
        String endtime = testContext.endtime.toString()
        Date dateEndTime = DateUtil.strToDate(endtime)
        String channel = testContext.channel.toString()
        List orderStatus = new ArrayList()
        testContext.orderStatus.toString().split(",").each {it->orderStatus.add(Integer.parseInt(it.toString()))}
        //assert itemDayCount > 0
        List<Integer> userIds = [14753020 ,
                                 8630588  ,
                                 22428284 ,
                                 26836028 ,
                                 7466364  ,
                                 23636540 ,
                                 7588732  ,
                                 9422332  ,
                                 21688764 ,
                                 8768828  ,
                                 9237884  ,
                                 11941500 ,
                                 12785084 ,
                                 20431676 ,
                                 8283900  ,
                                 13039868 ,
                                 18042172 ,
                                 6109692  ,
                                 7758524  ,
                                 21733500 ,
                                 9477116  ,
                                 26865788 ,
                                 7247292  ,
                                 29315644 ,
                                 29487676 ,
                                 23194684 ,
                                 18141948 ,
                                 11340092 ,
                                 16467260 ,
                                 8912892  ,
                                 11901052 ,
                                 14627260 ,
                                 21813692 ,
                                 7501244  ,
                                 12927036 ,
                                 12173692 ,
                                 7893116  ,
                                 7692284  ,
                                 18628284 ,
                                 7493884  ,
                                 7020732  ,
                                 6932796  ,
                                 13364156 ,
                                 17947772 ,
                                 11930236 ,
                                 8113532  ,
                                 8117500  ,
                                 14499580 ,
                                 7399484  ,
                                 7485372  ,
                                 21940860 ,
                                 24948284 ,
                                 28530108 ,
                                 6771964  ,
                                 16978172 ,
                                 13891452 ,
                                 10589244 ,
                                 26558268 ,
                                 7229884  ,
                                 9298172  ,
                                 29439100 ,
                                 11743932 ,
                                 17236732 ,
                                 16658748 ,
                                 25328572 ,
                                 19808060 ,
                                 27151676 ,
                                 27215484 ,
                                 12980220 ,
                                 24567996 ,
                                 19709180 ,
                                 9394684  ,
                                 13714044 ,
                                 10468092 ,
                                 22504892 ,
                                 19289916 ,
                                 8437564  ,
                                 7633980  ,
                                 29289340 ,
                                 8091068  ,
                                 10563388 ,
                                 27502972 ,
                                 8421692  ,
                                 21594748 ,
                                 8429628  ,
                                 18762940 ,
                                 9911484  ,
                                 8796860  ,
                                 7246332  ,
                                 27187068 ,
                                 24244476 ,
                                 20932092 ,
                                 14273916 ,
                                 29259516 ,
                                 22611516 ,
                                 9938812  ,
                                 28244540 ,
                                 14556284 ,
                                 7631292  ,
                                 12694524 ,
                                 15439740 ,
                                 28547708 ,
                                 8004796  ,
                                 7610172  ,
                                 8268604  ,
                                 20758844 ,
                                 11111932 ,
                                 21289148 ,
                                 13606332 ,
                                 10383804 ,
                                 22166012 ,
                                 12497084 ,
                                 23340668 ,
                                 7403900  ,
                                 14409148 ,
                                 15612348 ,
                                 6618620  ,
                                 7243132  ,
                                 7944508  ,
                                 2346172  ,
                                 11040316 ,
                                 7824252  ,
                                 7087996  ,
                                 14918652 ,
                                 13688124 ,
                                 577788   ,
                                 10644860 ,
                                 16022780 ,
                                 8639804  ,
                                 11932476 ,
                                 16050940 ,
                                 29541052 ,
                                 24453116 ,
                                 18648380 ,
                                 24331324 ,
                                 18682812 ,
                                 22547516 ,
                                 12752060 ,
                                 9801468  ,
                                 17008188 ,
                                 7611644  ,
                                 21506428 ,
                                 6618108  ,
                                 14875836 ,
                                 11211836 ,
                                 22373244 ,
                                 6693372  ,
                                 13422588 ,
                                 7990652  ,
                                 15905212 ,
                                 9684156  ,
                                 12443516 ,
                                 12066364 ,
                                 24182524 ,
                                 22147388 ,
                                 12770492 ,
                                 12490620 ,
                                 11420284 ,
                                 20342972 ,
                                 9589308  ,
                                 9669180  ,
                                 11915260 ,
                                 27692476 ,
                                 11434172 ,
                                 23988220 ,
                                 25847676 ,
                                 7055228  ,
                                 18180924 ,
                                 14362620 ,
                                 12653628 ,
                                 7082876  ,
                                 11169788 ,
                                 26866044 ,
                                 23563452 ,
                                 7299964  ,
                                 7968444  ,
                                 14645564 ,
                                 7125628  ,
                                 7375228  ,
                                 8119996  ,
                                 7355324  ,
                                 23457596 ,
                                 16817724 ,
                                 8054716  ,
                                 7533948  ,
                                 6930492  ,
                                 20652348 ,
                                 18128828 ,
                                 14822332 ,
                                 6977596  ,
                                 14063484 ,
                                 7352636  ,
                                 9325948  ,
                                 15773820 ,
                                 28215036 ,
                                 15912892 ,
                                 11281404 ,
                                 20382844 ,
                                 15895484 ,
                                 19975484 ,
                                 9779772  ,
                                 17185916 ,
                                 10735036 ,
                                 7841020  ,
                                 23080508 ,
                                 23774268 ,
                                 18442812 ,
                                 9348924  ,
                                 14366332 ,
                                 7130236  ,
                                 7209788  ,
                                 22205180 ,
                                 15314492 ,
                                 29635132 ,
                                 13014332 ,
                                 12709948 ,
                                 1990076  ,
                                 29313148 ,
                                 19578684 ,
                                 19104700 ,
                                 19011516 ,
                                 6744188  ,
                                 22106876 ,
                                 24012796 ,
                                 7088188  ,
                                 29016060 ,
                                 20730108 ,
                                 16527420 ,
                                 14216700 ,
                                 8407484  ,
                                 8564028  ,
                                 12169788 ,
                                 15197500 ,
                                 6905212  ,
                                 12806396 ,
                                 14031484 ,
                                 28457596 ,
                                 7420092  ,
                                 28666876 ,
                                 3116028  ,
                                 13013500 ,
                                 6893820  ,
                                 12809276 ,
                                 22388412 ,
                                 13731388 ,
                                 7300604  ,
                                 14428860 ,
                                 12921660 ,
                                 7074684  ,
                                 16806588 ,
                                 16884668 ,
                                 10402556 ,
                                 20186620 ,
                                 15235068 ,
                                 22098812 ,
                                 20296124 ,
                                 15600892 ,
                                 16405500 ,
                                 12250044 ,
                                 19678012 ,
                                 23387132 ,
                                 13156988 ,
                                 8258620  ,
                                 16523324 ,
                                 7014844  ,
                                 22810812 ,
                                 7255548  ,
                                 27258940 ,
                                 10187004 ,
                                 7398844  ,
                                 2019516  ,
                                 15003900 ,
                                 12138876 ,
                                 12613372 ,
                                 10326396 ,
                                 6688316  ,
                                 6925180  ,
                                 9637500  ,
                                 17326972 ,
                                 391868   ,
                                 15619900 ,
                                 16204860 ,
                                 20248764 ,
                                 8016828  ,
                                 13049980 ,
                                 23901500 ,
                                 7400700  ,
                                 28777916 ,
                                 12973948 ,
                                 8578556  ,
                                 13434940 ,
                                 7708156  ,
                                 7776828  ,
                                 11521980 ,
                                 10248636 ,
                                 21043132 ,
                                 17254780 ,
                                 13952380 ,
                                 7394876  ,
                                 12116220 ,
                                 22483900 ,
                                 6958332  ,
                                 24028348 ,
                                 7890044  ,
                                 16949820 ,
                                 24057468 ,
                                 11966460 ,
                                 15522172 ,
                                 13088572 ,
                                 22168764 ,
                                 26594876 ,
                                 14300860 ,
                                 15166268 ,
                                 29454780 ,
                                 12119484 ,
                                 17895356 ,
                                 8102780  ,
                                 8602684  ,
                                 14686908 ,
                                 16745788 ,
                                 7038588  ,
                                 12554748 ,
                                 18090748 ,
                                 22295804 ,
                                 11968316 ,
                                 13792188 ,
                                 26698044 ,
                                 11020924 ,
                                 27096828 ,
                                 7502012  ,
                                 20541372 ,
                                 21848828 ,
                                 8489532  ,
                                 21465852 ,
                                 23685564 ,
                                 16457788 ,
                                 11001468 ,
                                 8277884  ,
                                 19174908 ,
                                 12837308 ,
                                 27658044 ,
                                 8310972  ,
                                 7114876  ,
                                 10835388 ,
                                 29068348 ,
                                 8761788  ,
                                 7634044  ,
                                 13728252 ,
                                 10436540 ,
                                 17814972 ,
                                 19659196 ,
                                 22253052 ,
                                 14149820 ,
                                 11445116 ,
                                 10714364 ,
                                 21405564 ,
                                 18323132 ,
                                 9195836  ,
                                 17874044 ,
                                 9412668  ,
                                 28331388 ,
                                 23606012 ,
                                 10371068 ,
                                 9275324  ,
                                 10492220 ,
                                 11425660 ,
                                 15800636 ,
                                 14389180 ,
                                 11675388 ,
                                 20202748 ,
                                 6758844  ,
                                 24517756 ,
                                 22494908 ,
                                 21485564 ,
                                 18283836 ,
                                 23093500 ,
                                 16393852 ,
                                 22381756 ,
                                 11032764 ,
                                 12002108 ,
                                 9640636  ,
                                 7685308  ,
                                 22057404 ,
                                 29082172 ,
                                 12899644 ,
                                 24399100 ,
                                 21189884 ,
                                 7763196  ,
                                 9184316  ,
                                 22338236 ,
                                 11616380 ,
                                 22899260 ,
                                 13282812 ,
                                 21644092 ,
                                 18624508 ,
                                 18493500 ,
                                 29757052 ,
                                 20220732 ,
                                 7269244  ,
                                 19820796 ,
                                 19316581 ,
                                 19721061 ,
                                 24301413 ,
                                 19791653 ,
                                 18415525 ,
                                 14088741 ,
                                 28967397 ,
                                 12301797 ,
                                 21792997 ,
                                 29036261 ,
                                 15515493 ,
                                 29033637 ,
                                 29922469 ,
                                 27372581 ,
                                 15758053 ,
                                 22501925 ,
                                 16208805 ,
                                 23578981 ,
                                 23103589 ,
                                 29873317 ,
                                 28843685 ,
                                 19475109 ,
                                 15951397 ,
                                 17583717 ,
                                 27719717 ,
                                 29066661 ,
                                 12257317 ,
                                 28998565 ,
                                 29458085 ,
                                 10769061 ,
                                 7710373  ,
                                 20332389 ,
                                 6910501  ,
                                 10949157 ,
                                 17282917 ,
                                 18510309 ,
                                 29225317 ,
                                 18278629 ,
                                 8775205  ,
                                 29454181 ,
                                 29086117 ,
                                 28255461 ,
                                 16319845 ,
                                 23990949 ,
                                 16899045 ,
                                 6929125  ,
                                 18272741 ,
                                 22951205 ,
                                 7347813  ,
                                 17118629 ,
                                 22266661 ,
                                 7563621  ,
                                 21367141 ,
                                 11287013 ,
                                 28518309 ,
                                 28082405 ,
                                 29086885 ,
                                 6626085  ,
                                 18340069 ,
                                 17262821 ,
                                 12695077 ,
                                 22084517 ,
                                 27478565 ,
                                 8701477  ,
                                 17738661 ,
                                 7331237  ,
                                 12851749 ,
                                 11447653 ,
                                 29909669 ,
                                 8033573  ,
                                 14694693 ,
                                 8135397  ,
                                 29045029 ,
                                 23717477 ,
                                 22319589 ,
                                 7295525  ,
                                 22126885 ,
                                 15203941 ,
                                 23646053 ,
                                 27507621 ,
                                 17410981 ,
                                 28406885 ,
                                 17622693 ,
                                 18542181 ,
                                 13249061 ,
                                 27568805 ,
                                 28905829 ,
                                 9029733  ,
                                 16483557 ,
                                 9596453  ,
                                 29318821 ,
                                 24097253 ,
                                 14918885 ,
                                 20350501 ,
                                 8076133  ,
                                 17478181 ,
                                 29542565 ,
                                 11971173 ,
                                 8752485  ,
                                 11218469 ,
                                 22942565 ,
                                 9596709  ,
                                 16746789 ,
                                 22460389 ,
                                 29804709 ,
                                 14008805 ,
                                 26622117 ,
                                 13399461 ,
                                 16262629 ,
                                 24758117 ,
                                 7478437  ,
                                 29913381 ,
                                 7787173  ,
                                 15847653 ,
                                 13988517 ,
                                 15582885 ,
                                 7641061  ,
                                 13764389 ,
                                 24007205 ,
                                 7490341  ,
                                 7722725  ,
                                 20092197 ,
                                 26753253 ,
                                 14498725 ,
                                 9241317  ,
                                 27632741 ,
                                 21772069 ,
                                 25496549 ,
                                 29096869 ,
                                 20175653 ,
                                 8527589  ,
                                 9969061  ,
                                 18324581 ,
                                 28985765 ,
                                 10270181 ,
                                 16915941 ,
                                 14268709 ,
                                 19977381 ,
                                 13398565 ,
                                 15472677 ,
                                 29296101 ,
                                 22156581 ,
                                 22975845 ,
                                 10699877 ,
                                 27528997 ,
                                 8247909  ,
                                 10738917 ,
                                 25181733 ,
                                 23759653 ,
                                 14306661 ,
                                 19394149 ,
                                 28405157 ,
                                 28507749 ,
                                 7523813  ,
                                 11219045 ,
                                 21752677 ,
                                 29427109 ,
                                 10312805 ,
                                 9457445  ,
                                 22349861 ,
                                 29138853 ,
                                 16963685 ,
                                 15968549 ,
                                 7489701  ,
                                 18607653 ,
                                 9924069  ,
                                 22701029 ,
                                 29153125 ,
                                 22204965 ,
                                 7267621  ,
                                 24553061 ,
                                 7399909  ,
                                 19154533 ,
                                 22652133 ,
                                 29419429 ,
                                 28963301 ,
                                 22293349 ,
                                 18835941 ,
                                 14385061 ,
                                 7885541  ,
                                 10927973 ,
                                 27071717 ,
                                 7148837  ,
                                 7480485  ,
                                 28889125 ,
                                 27296549 ,
                                 15641189 ,
                                 16776101 ,
                                 10688101 ,
                                 24861605 ,
                                 22170981 ,
                                 29081637 ,
                                 27168869 ,
                                 9435621  ,
                                 22612389 ,
                                 6773669  ,
                                 17140709 ,
                                 20542373 ,
                                 29464165 ,
                                 17115941 ,
                                 22577317 ,
                                 28345573 ,
                                 20150245 ,
                                 11404453 ,
                                 12974949 ,
                                 27832165 ,
                                 20362917 ,
                                 8020069  ,
                                 7896357  ,
                                 29232037 ,
                                 28165285 ,
                                 13548837 ,
                                 7875237  ,
                                 14734181 ,
                                 27086437 ,
                                 13238373 ,
                                 20489573 ,
                                 9524709  ,
                                 7331941  ,
                                 22353061 ,
                                 11138405 ,
                                 17814629 ,
                                 29136741 ,
                                 17124069 ,
                                 6596005  ,
                                 17024613 ,
                                 29642277 ,
                                 24139365 ,
                                 23202725 ,
                                 11553189 ,
                                 8702629  ,
                                 10879653 ,
                                 11392229 ,
                                 20048805 ,
                                 7403813  ,
                                 6888421  ,
                                 19026917 ,
                                 16558437 ,
                                 6788389  ,
                                 25551141 ,
                                 8249317  ,
                                 29453989 ,
                                 18241509 ,
                                 16912421 ,
                                 10958373 ,
                                 9762021  ,
                                 13316965 ,
                                 24076069 ,
                                 10783077 ,
                                 17162213 ,
                                 6881765  ,
                                 19214693 ,
                                 15978789 ,
                                 6648357  ,
                                 12644261 ,
                                 16061349 ,
                                 14189541 ,
                                 19787301 ,
                                 7938725  ,
                                 18474277 ,
                                 14313701 ,
                                 29206117 ,
                                 22121189 ,
                                 10436197 ,
                                 8789221  ,
                                 28855973 ,
                                 26511653 ,
                                 28959461 ,
                                 12160485 ,
                                 13522405 ,
                                 8442341  ,
                                 22808741 ,
                                 22776357 ,
                                 10731301 ,
                                 8623781  ,
                                 7802085  ,
                                 27520101 ,
                                 21803173 ,
                                 7239717  ,
                                 9846693  ,
                                 7498789  ,
                                 6755941  ,
                                 27644453 ,
                                 10576549 ,
                                 22776613 ,
                                 14484581 ,
                                 24059365 ,
                                 19488485 ,
                                 9836453  ,
                                 7139749  ,
                                 9663781  ,
                                 29306981 ,
                                 14832101 ,
                                 21853989 ,
                                 27105765 ,
                                 7995685  ,
                                 9934053  ,
                                 17518501 ,
                                 6990245  ,
                                 26678821 ,
                                 20952613 ,
                                 28450149 ,
                                 14151909 ,
                                 18050469 ,
                                 7996965  ,
                                 18613285 ,
                                 9572069  ,
                                 23411941 ,
                                 24863845 ,
                                 28756133 ,
                                 29022565 ,
                                 29276325 ,
                                 19962341 ,
                                 7970277  ,
                                 12801125 ,
                                 28351973 ,
                                 8644261  ,
                                 8295205  ,
                                 9970405  ,
                                 10111973 ,
                                 11015525 ,
                                 10998245 ,
                                 29222181 ,
                                 12206885 ,
                                 7361253  ,
                                 22742821 ,
                                 10266853 ,
                                 19391013 ,
                                 26763813 ,
                                 26789797 ,
                                 13791461 ,
                                 18807013 ,
                                 14946405 ,
                                 16566565 ,
                                 14629861 ,
                                 9699301  ,
                                 23091813 ,
                                 10637541 ,
                                 27316581 ,
                                 17171173 ,
                                 13915045 ,
                                 12189925 ,
                                 26676389 ,
                                 20078501 ,
                                 5825189  ,
                                 20094885 ,
                                 13141733 ,
                                 28631333 ,
                                 8019301  ,
                                 13221605 ,
                                 15493605 ,
                                 29420645 ,
                                 23529253 ,
                                 27558373 ,
                                 29440229 ,
                                 7620197  ,
                                 19793893 ,
                                 21381541 ,
                                 12915941 ,
                                 29233445 ,
                                 13650533 ,
                                 8756261  ,
                                 22848549 ,
                                 14537957 ,
                                 7628645  ,
                                 19114149 ,
                                 16329701 ,
                                 7907941  ,
                                 26380133 ,
                                 28694245 ,
                                 29069861 ,
                                 29539365 ,
                                 10082853 ,
                                 27830949 ,
                                 22303525 ,
                                 7054309  ,
                                 9941157  ,
                                 29149861 ,
                                 16572837 ,
                                 13398437 ,
                                 8858085  ,
                                 29341733 ,
                                 26623781 ,
                                 11624869 ,
                                 18723429 ,
                                 8959013  ,
                                 16799205 ,
                                 22381221 ,
                                 27533541 ,
                                 7300709  ,
                                 21867877 ,
                                 13232997 ,
                                 9906533  ,
                                 23083365 ,
                                 6638181  ,
                                 29682917 ,
                                 22852197 ,
                                 27195941 ,
                                 9304357  ,
                                 15124069 ,
                                 17049854 ,
                                 8166974  ,
                                 17529790 ,
                                 29531646 ,
                                 6828414  ,
                                 8409918  ,
                                 11905342 ,
                                 11048830 ,
                                 6959166  ,
                                 19759870 ,
                                 27233726 ,
                                 27887230 ,
                                 15817598 ,
                                 25525438 ,
                                 13871934 ,
                                 10124926 ,
                                 7495742  ,
                                 22470142 ,
                                 9875966  ,
                                 2106878  ,
                                 19093438 ,
                                 20375806 ,
                                 28249854 ,
                                 22926014 ,
                                 7512510  ,
                                 11162558 ,
                                 28668414 ,
                                 28267262 ,
                                 16876606 ,
                                 18687422 ,
                                 6671806  ,
                                 19257534 ,
                                 9866750  ,
                                 22059710 ,
                                 28300862 ,
                                 21766014 ,
                                 10428542 ,
                                 11413310 ,
                                 18253758 ,
                                 14861182 ,
                                 10781054 ,
                                 17733886 ,
                                 18635198 ,
                                 16351358 ,
                                 21744958 ,
                                 18243774 ,
                                 7765182  ,
                                 7461758  ,
                                 20448190 ,
                                 6700606  ,
                                 20269246 ,
                                 19065534 ,
                                 28971646 ,
                                 16682174 ,
                                 22088830 ,
                                 7343550  ,
                                 17284030 ,
                                 28300030 ,
                                 7361150  ,
                                 12679038 ,
                                 9419070  ,
                                 8217790  ,
                                 28168830 ,
                                 21354878 ,
                                 24969150 ,
                                 7077886  ,
                                 13328702 ,
                                 22400638 ,
                                 18467070 ,
                                 26457342 ,
                                 23645438 ,
                                 24931646 ,
                                 18211454 ,
                                 22728510 ,
                                 22813246 ,
                                 29413566 ,
                                 28735486 ,
                                 26545790 ,
                                 23700158 ,
                                 29443582 ,
                                 16310782 ,
                                 29622590 ,
                                 22616126 ,
                                 21871230 ,
                                 11452734 ,
                                 22730238 ,
                                 14233342 ,
                                 27078974 ,
                                 29715006 ,
                                 19647102 ,
                                 24964606 ,
                                 17762238 ,
                                 26834046 ,
                                 13442174 ,
                                 9645310  ,
                                 29714430 ,
                                 10302270 ,
                                 15486782 ,
                                 27063166 ,
                                 14309950 ,
                                 24421694 ,
                                 29430462 ,
                                 17524862 ,
                                 20731774 ,
                                 28974846 ,
                                 8096958  ,
                                 29161534 ,
                                 10865086 ,
                                 23641982 ,
                                 6954814  ,
                                 22679038 ,
                                 19464126 ,
                                 10981950 ,
                                 21694270 ,
                                 22261886 ,
                                 21887614 ,
                                 14107646 ,
                                 23408830 ,
                                 20660798 ,
                                 17296574 ,
                                 29459902 ,
                                 7049278  ,
                                 26500862 ,
                                 7070334  ,
                                 8019390  ,
                                 23135166 ,
                                 14422078 ,
                                 23120894 ,
                                 13697022 ,
                                 27004542 ,
                                 13670398 ,
                                 28794430 ,
                                 13694206 ,
                                 28603454 ,
                                 15493630 ,
                                 27775998 ,
                                 21906814 ,
                                 11653502 ,
                                 27288062 ,
                                 8975230  ,
                                 18013694 ,
                                 21597438 ,
                                 22979710 ,
                                 16494334 ,
                                 17178686 ,
                                 28791870 ,
                                 8906046  ,
                                 16313534 ,
                                 8742526  ,
                                 12175294 ,
                                 8112958  ,
                                 19378686 ,
                                 14945214 ,
                                 12553342 ,
                                 20899646 ,
                                 21075134 ,
                                 22437630 ,
                                 14395198 ,
                                 16060542 ,
                                 15754622 ,
                                 7047102  ,
                                 7340798  ,
                                 29707134 ,
                                 9066814  ,
                                 15675070 ,
                                 9139006  ,
                                 20490110 ,
                                 28095806 ,
                                 8646590  ,
                                 18826942 ,
                                 9267390  ,
                                 22979902 ,
                                 27445758 ,
                                 13520766 ,
                                 6873790  ,
                                 12526718 ,
                                 10457726 ,
                                 21390590 ,
                                 7311550  ,
                                 15617214 ,
                                 11232958 ,
                                 12043838 ,
                                 19184510 ,
                                 20968638 ,
                                 6879166  ,
                                 28253374 ,
                                 19082686 ,
                                 28216318 ,
                                 16535358 ,
                                 19515774 ,
                                 8240062  ,
                                 12431038 ,
                                 21068286 ,
                                 8340862  ,
                                 27510142 ,
                                 14831422 ,
                                 16446270 ,
                                 6581310  ,
                                 9246334  ,
                                 8320190  ,
                                 13442110 ,
                                 27857918 ,
                                 16058174 ,
                                 12490942 ,
                                 12560830 ,
                                 11302078 ,
                                 6868478  ,
                                 13355134 ,
                                 29588350 ,
                                 23331838 ,
                                 10614078 ,
                                 22714750 ,
                                 24089470 ,
                                 14601534 ,
                                 29592766 ,
                                 21626622 ,
                                 17360382 ,
                                 28722366 ,
                                 18091966 ,
                                 24591230 ,
                                 11669630 ,
                                 16815422 ,
                                 11474750 ,
                                 7067518  ,
                                 19976062 ,
                                 28807102 ,
                                 6791998  ,
                                 6716030  ,
                                 20097662 ,
                                 29416702 ,
                                 29044862 ,
                                 11442558 ,
                                 29631358 ,
                                 19708926 ,
                                 16518014 ,
                                 8064190  ,
                                 29498238 ,
                                 13461054 ,
                                 28001790 ,
                                 9611838  ,
                                 29173310 ,
                                 7979710  ,
                                 23652094 ,
                                 8529982  ,
                                 17447166 ,
                                 26678270 ,
                                 27056894 ,
                                 12735678 ,
                                 27136062 ,
                                 15394238 ,
                                 18735358 ,
                                 8365118  ,
                                 28726078 ,
                                 10225726 ,
                                 13554366 ,
                                 9517182  ,
                                 28053246 ,
                                 16994238 ,
                                 19608638 ,
                                 21048510 ,
                                 15782526 ,
                                 9739838  ,
                                 28087550 ,
                                 12817726 ,
                                 27405630 ,
                                 15245246 ,
                                 28234750 ,
                                 16758078 ,
                                 16545086 ,
                                 9559230  ,
                                 22854398 ,
                                 10763454 ,
                                 10180414 ,
                                 17100286 ,
                                 18414782 ,
                                 8344254  ,
                                 17361470 ,
                                 29698302 ,
                                 23780478 ,
                                 7546366  ,
                                 28156990 ,
                                 28154174 ,
                                 27496702 ,
                                 9620926  ,
                                 16539838 ,
                                 21437054 ,
                                 19989822 ,
                                 13148414 ,
                                 8255742  ,
                                 23120702 ,
                                 14234814 ,
                                 29297790 ,
                                 9863614  ,
                                 14920510 ,
                                 29317822 ,
                                 29255230 ,
                                 17957694 ,
                                 27336958 ,
                                 10425150 ,
                                 21620798 ,
                                 7877502  ,
                                 18769022 ,
                                 29776766 ,
                                 21896446 ,
                                 10781246 ,
                                 8587390  ,
                                 14311742 ,
                                 15300478 ,
                                 10869182 ,
                                 16830654 ,
                                 13031742 ,
                                 27588478 ,
                                 8717950  ,
                                 29606654 ,
                                 29514750 ,
                                 12549438 ,
                                 11532734 ,
                                 28053822 ,
                                 27859774 ,
                                 10012158 ,
                                 14215294 ,
                                 23538686 ,
                                 23739710 ,
                                 23386942 ,
                                 12572606 ,
                                 28482750 ,
                                 8178110  ,
                                 23426110 ,
                                 9209854  ,
                                 11109182 ,
                                 12490238 ,
                                 27068542 ,
                                 12518014 ,
                                 6406334  ,
                                 9235582  ,
                                 20453502 ,
                                 27027902 ,
                                 16805822 ,
                                 7352126  ,
                                 9631038  ,
                                 27508862 ,
                                 6720510  ,
                                 29209150 ,
                                 27342014 ,
                                 7679166  ,
                                 13037694 ,
                                 13344510 ,
                                 29105150 ,
                                 11046974 ,
                                 27036222 ,
                                 7860158  ,
                                 28851262 ,
                                 7460606  ,
                                 9751230  ,
                                 9459198  ,
                                 29471038 ,
                                 14353854 ,
                                 7806014  ,
                                 18182590 ,
                                 29271294 ,
                                 13164542 ,
                                 10081854 ,
                                 15855486 ,
                                 26354430 ,
                                 18955518 ,
                                 22357118 ,
                                 28317374 ,
                                 22328574 ,
                                 10416318 ,
                                 27886206 ,
                                 27768190 ,
                                 11628286 ,
                                 12684222 ,
                                 27101310 ,
                                 9402174  ,
                                 29199678 ,
                                 26030334 ,
                                 8365246  ,
                                 17406526 ,
                                 7631550  ,
                                 18310974 ,
                                 678526   ,
                                 12500030 ,
                                 25956030 ,
                                 22650302 ,
                                 23126526 ,
                                 28890814 ,
                                 28017342 ,
                                 13096894 ,
                                 28003902 ,
                                 28446590 ,
                                 14478654 ,
                                 28080574 ,
                                 23717694 ,
                                 9358334  ,
                                 29206334 ,
                                 15860286 ,
                                 13910718 ,
                                 28582334 ,
                                 28506110 ,
                                 2737431  ,
                                 23541847 ,
                                 28428631 ,
                                 13978711 ,
                                 27959319 ,
                                 12277783 ,
                                 28165783 ,
                                 13503575 ,
                                 29307543 ,
                                 17590359 ,
                                 9398487  ,
                                 12955031 ,
                                 9602391  ,
                                 495575   ,
                                 14071319 ,
                                 7231383  ,
                                 8307735  ,
                                 25955543 ,
                                 7264151  ,
                                 13193751 ,
                                 12602519 ,
                                 8700759  ,
                                 18851607 ,
                                 20010199 ,
                                 21482263 ,
                                 29772119 ,
                                 8079959  ,
                                 12864791 ,
                                 15827479 ,
                                 23897623 ,
                                 18511895 ,
                                 2045847  ,
                                 22482647 ,
                                 19985943 ,
                                 11574103 ,
                                 10531799 ,
                                 18771479 ,
                                 8584599  ,
                                 22769559 ,
                                 13142231 ,
                                 13215959 ,
                                 28226327 ,
                                 7069015  ,
                                 23216343 ,
                                 7858839  ,
                                 23308759 ,
                                 16738647 ,
                                 14224791 ,
                                 8085975  ,
                                 8272599  ,
                                 7045079  ,
                                 7337431  ,
                                 14696343 ,
                                 7109911  ,
                                 6441495  ,
                                 17644631 ,
                                 29564695 ,
                                 9696919  ,
                                 9386199  ,
                                 28381975 ,
                                 20123159 ,
                                 21262807 ,
                                 16980823 ,
                                 7954903  ,
                                 7513303  ,
                                 8190935  ,
                                 8722327  ,
                                 18214167 ,
                                 28346263 ,
                                 22432983 ,
                                 23408983 ,
                                 9904535  ,
                                 23596119 ,
                                 7259607  ,
                                 24381527 ,
                                 18057303 ,
                                 12112791 ,
                                 10732375 ,
                                 20707415 ,
                                 20316631 ,
                                 13301911 ,
                                 22092887 ,
                                 7143767  ,
                                 14275927 ,
                                 7685975  ,
                                 7602519  ,
                                 13462359 ,
                                 18244375 ,
                                 7847703  ,
                                 28003287 ,
                                 9002007  ,
                                 14276759 ,
                                 10267863 ,
                                 13535191 ,
                                 22728471 ,
                                 6883159  ,
                                 18434519 ,
                                 7924183  ,
                                 18514839 ,
                                 10235671 ,
                                 12696215 ,
                                 12759959 ,
                                 2025111  ,
                                 28236247 ,
                                 7881879  ,
                                 7712407  ,
                                 8031319  ,
                                 28985815 ,
                                 19384215 ,
                                 20497623 ,
                                 7455383  ,
                                 23980247 ,
                                 28192023 ,
                                 11180247 ,
                                 22515799 ,
                                 12791895 ,
                                 29223895 ,
                                 23014231 ,
                                 28517207 ,
                                 29656215 ,
                                 9838359  ,
                                 15900759 ,
                                 22898775 ,
                                 28720023 ,
                                 29285399 ,
                                 10802903 ,
                                 16332887 ,
                                 7483927  ,
                                 12307287 ,
                                 7506071  ,
                                 28118871 ,
                                 6768791  ,
                                 20971607 ,
                                 7238807  ,
                                 12241367 ,
                                 8746263  ,
                                 11584471 ,
                                 21794775 ,
                                 21601303 ,
                                 23900119 ,
                                 20947799 ,
                                 8198999  ,
                                 17589911 ,
                                 9761239  ,
                                 1748759  ,
                                 13534615 ,
                                 29596887 ,
                                 17036311 ,
                                 10903383 ,
                                 13036631 ,
                                 24508183 ,
                                 11514903 ,
                                 29562135 ,
                                 9397079  ,
                                 15847127 ,
                                 13134679 ,
                                 14061847 ,
                                 12227031 ,
                                 13747607 ,
                                 8119831  ,
                                 7894359  ,
                                 8779159  ,
                                 9713879  ,
                                 27945495 ,
                                 21905111 ,
                                 14698327 ,
                                 17754071 ,
                                 7384151  ,
                                 23362775 ,
                                 28234903 ,
                                 9667927  ,
                                 15828055 ,
                                 21619671 ,
                                 25676183 ,
                                 23954263 ,
                                 7300695  ,
                                 27910295 ,
                                 21011735 ,
                                 19672983 ,
                                 17456663 ,
                                 23680535 ,
                                 11650519 ,
                                 10065879 ,
                                 28062167 ,
                                 27123287 ,
                                 22430231 ,
                                 6581335  ,
                                 20265047 ,
                                 12300503 ,
                                 18207255 ,
                                 15131479 ,
                                 6973655  ,
                                 9098711  ,
                                 7878807  ,
                                 28245591 ,
                                 29080983 ,
                                 10122519 ,
                                 13517527 ,
                                 29122839 ,
                                 10275991 ,
                                 10775191 ,
                                 22155159 ,
                                 7031575  ,
                                 16952535 ,
                                 12656087 ,
                                 28516503 ,
                                 29643863 ,
                                 17083863 ,
                                 29404183 ,
                                 25251543 ,
                                 9863959  ,
                                 8483927  ,
                                 20349655 ,
                                 12230103 ,
                                 11013975 ,
                                 23694423 ,
                                 12901079 ,
                                 14981207 ,
                                 22994647 ,
                                 16861143 ,
                                 21393303 ,
                                 21788631 ,
                                 28661719 ,
                                 7445847  ,
                                 28451863 ,
                                 8200151  ,
                                 21785175 ,
                                 10549783 ,
                                 28267543 ,
                                 23913431 ,
                                 9439895  ,
                                 12891031 ,
                                 10325655 ,
                                 7837271  ,
                                 10654871 ,
                                 10810775 ,
                                 27267863 ,
                                 8468823  ,
                                 14629591 ,
                                 10255319 ,
                                 7927511  ,
                                 21711511 ,
                                 21522199 ,
                                 24053975 ,
                                 13799063 ,
                                 11089687 ,
                                 20013783 ,
                                 9728215  ,
                                 18591383 ,
                                 12092183 ,
                                 18436631 ,
                                 7653911  ,
                                 15118743 ,
                                 15249367 ,
                                 10584343 ,
                                 11317015 ,
                                 12767511 ,
                                 6600855  ,
                                 10279447 ,
                                 27514455 ,
                                 7863831  ,
                                 27205719 ,
                                 19296855 ,
                                 28463767 ,
                                 26530583 ,
                                 12230679 ,
                                 7645911  ,
                                 20048343 ,
                                 10393623 ,
                                 11332823 ,
                                 17606871 ,
                                 7439895  ,
                                 20373655 ,
                                 29194455 ,
                                 28544151 ,
                                 20639959 ,
                                 19649751 ,
                                 24580823 ,
                                 8105431  ,
                                 6682135  ,
                                 28462615 ,
                                 7448727  ,
                                 12136535 ,
                                 1904151  ,
                                 22762647 ,
                                 17142935 ,
                                 19867351 ,
                                 9344791  ,
                                 12476695 ,
                                 6920855  ,
                                 27023639 ,
                                 18775895 ,
                                 21494871 ,
                                 9827415  ,
                                 22733719 ,
                                 9663191  ,
                                 24282647 ,
                                 19672343 ,
                                 8387031  ,
                                 6835223  ,
                                 8892183  ,
                                 16197911 ,
                                 26642519 ,
                                 16706903 ,
                                 11274199 ,
                                 8817559  ,
                                 23701527 ,
                                 17040919 ,
                                 28463447 ,
                                 23257815 ,
                                 13074711 ,
                                 12835991 ,
                                 6934743  ,
                                 9182743  ,
                                 18318871 ,
                                 26360407 ,
                                 23081367 ,
                                 19219735 ,
                                 17031959 ,
                                 6855447  ,
                                 8133591  ,
                                 27734231 ,
                                 7648343  ,
                                 9645015  ,
                                 28228247 ,
                                 23279127 ,
                                 21463063 ,
                                 19442967 ,
                                 7757911  ,
                                 11927959 ,
                                 17296215 ,
                                 18299159 ,
                                 20773015 ,
                                 8395863  ,
                                 13357783 ,
                                 11987927 ,
                                 7983063  ,
                                 16285015 ,
                                 14679511 ,
                                 9833047  ,
                                 12778711 ,
                                 10858007 ,
                                 23346199 ,
                                 7645463  ,
                                 28100823 ,
                                 16290583 ,
                                 17210007 ,
                                 29738903 ,
                                 11322071 ,
                                 19328599 ,
                                 29267991 ,
                                 29319319 ,
                                 8913751  ,
                                 24227223 ,
                                 28367191 ,
                                 21639511 ,
                                 8712983  ,
                                 26313687 ,
                                 15949975 ,
                                 10625943 ,
                                 17462039 ,
                                 28935575 ,
                                 10770583 ,
                                 28464407 ,
                                 9620119  ,
                                 11183319 ,
                                 27825687 ,
                                 8364183  ,
                                 14772823 ,
                                 11273047 ,
                                 8047511  ,
                                 9020567  ,
                                 9491735  ,
                                 24323735 ,
                                 17181783 ,
                                 18171415 ,
                                 23983703 ,
                                 12904535 ,
                                 8747479  ,
                                 16222871 ,
                                 11968215 ,
                                 17868631 ,
                                 27900119 ,
                                 29050775 ,
                                 20419863 ,
                                 17169367 ,
                                 7100759  ,
                                 23132183 ,
                                 27884311 ,
                                 7256919  ,
                                 23964887 ,
                                 7491991  ,
                                 29341591 ,
                                 26779543 ,
                                 13837719 ,
                                 8246103  ,
                                 23251031 ,
                                 8485399  ,
                                 11915223 ,
                                 8073367  ]

        Integer userIdSize = userIds.size()
        for (Integer i =0; i<userIdSize;i++){
            Integer userId = userIds.get(i)
            Date tmp = dateStarTime
            Calendar dd = Calendar.getInstance()
            dd.setTime(dateStarTime)
            while (tmp.getTime() < dateEndTime.getTime()) {
                tmp = dd.getTime()
                String tmpStr = DateUtil.dateToStr(tmp)
                Date tmpEnd= DateUtil.dateAdd(tmp,Calendar.MONTH,1)
                String tmpEndStr =DateUtil.dateToStr(tmpEnd)
                List mysqlChannelMonthlistlist = OrderService.getMysqlChannlMonth(userId, channel, tmp)

                    Integer itemDayCount = OrderService.getOrderItemCount(userId, channel, tmpStr, tmpEndStr).itemCunt
                    Integer sumDayCommission =OrderService.getOrderItemCommission(userId, channel, tmpStr, tmpEndStr).itemCommission
                    List dbDaySum = OrderService.getSumOrder(userId, channel, orderStatus,tmp,tmpEnd)
                   Integer  mysqlChannelMonthlistlistSize = mysqlChannelMonthlistlist.size()
                    Integer dbDaySumSize = dbDaySum.size()
                    if (mysqlChannelMonthlistlistSize ==0 && dbDaySumSize == 0){
                        println itemDayCount ==0
                        println sumDayCommission ==null
                        println("用户："+userId+"；；统计天数"+tmpStr+";;预估某天统计订单数"+itemDayCount+";;预估某天佣金"+sumDayCommission+";;mongodb订单数空"+";;mongodb佣金总数空")
                    }else{
                        mysqlChannelMonthlistlist.stream().forEach { mysqlChannelMonth ->
                            String statKey = mysqlChannelMonth.getAt("stat_key")
                            switch (statKey){
                                case 'CPS_ESTIMATE':
                                    if(dbDaySumSize == 0){
                                        println itemDayCount == mysqlChannelMonth.get("count")
                                        println sumDayCommission == mysqlChannelMonth.get("commission")
                                        println mysqlChannelMonth.get("commission") == 0
                                        println  mysqlChannelMonth.get("count")   == 0
                                        println("用户："+userId+"；；统计月数"+tmpStr+";;预估某月统计订单数"+itemDayCount+";;预估某月佣金"+sumDayCommission +";;mongodb订单数空"+";;mongodb佣金总数空")
                                    }
                                    else{
                                        println itemDayCount == mysqlChannelMonth.get("count")
                                        println sumDayCommission ==mysqlChannelMonth.get("commission")
                                        Integer dbCount =dbDaySum.get(0).cnt
                                        Integer dbCommission =dbDaySum.get(0).commission
                                        println dbCount == mysqlChannelMonth.get("count")
                                        println dbCommission ==mysqlChannelMonth.get("commission")
                                        println("用户"+userId+";;统计月数"+tmpStr+";;预估某月mysql明细订单数"+itemDayCount+";;预估某月mysql明细佣金"+sumDayCommission+";;mysqDay某月统计订单数"+mysqlChannelMonth.get("count")+";;mysqDay某月统计佣金"+mysqlChannelMonth.get("commission")+";;mongodb订单数"+dbCount+";;mongodb佣金总数"+dbCommission)
                                        break;
                                    }
                                case 'CPS_SETTLE':
                                    Integer settleItemDayCount=OrderService.getOrderSettleItemCount(userId, channel, tmpStr, tmpEndStr).itemCunt
                                    Integer sumSettleDayCommission =OrderService.getOrderSettleItemCommission(userId, channel, tmpStr, tmpEndStr).itemCommission
                                    List dbMonSumSettleList = OrderService.getSumSettleOrder(userId, channel,tmp,tmpEnd)
                                    Integer  dbMonSumSettleListSize = dbMonSumSettleList.size()
                                    if(dbMonSumSettleListSize ==0 ){
                                        println settleItemDayCount == mysqlChannelMonth.get("count")
                                        println sumSettleDayCommission ==mysqlChannelMonth.get("commission")

                                        println mysqlChannelMonth.get("commission") == 0
                                        println  mysqlChannelMonth.get("count")   == 0
                                        println("用户："+userId+"；；统计月数"+tmpStr+";;预估某月结算统计订单数"+settleItemDayCount+";;预估某月结算佣金"+sumSettleDayCommission +";;mongodb订单数空"+";;mongodb佣金总数空")
                                    }
                                    else{
                                println settleItemDayCount == mysqlChannelMonth.get("count")
                                println sumSettleDayCommission ==mysqlChannelMonth.get("commission")
                                Integer dbSettleCount =dbMonSumSettleList.get(0).cnt
                                Integer dbettleCommission =dbMonSumSettleList.get(0).commission
                                println dbSettleCount == mysqlChannelMonth.get("count")
                                println dbettleCommission == mysqlChannelMonth.get("commission")
                                println("用户："+userId+"；；统计月数"+tmpStr+";;预估某月MySQL明细结算统计订单数"+settleItemDayCount+";;预估某月某月MySQL明细结算佣金"+sumSettleDayCommission +"；；MySQL某月结算统计订单数："+mysqlChannelMonth.get("count")+"；；MySQL某月结算统计佣金："+mysqlChannelMonth.get("commission")+";;mongodb订单数"+dbSettleCount+";;mongodb佣金总数"+dbettleCommission)

                                break;
                                    }

                                case 'CPS_payment':
                                    println("没有付款统计")
                                    break;
                                default:
                                    println("统计类型不匹配");
                            }
                    }

                }

                // 天数加上1
                dd.add(Calendar.MONTH, 1)

            }

        }

    }
}
